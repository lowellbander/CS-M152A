\documentclass[]{article}

\usepackage{float}
\usepackage{graphicx}

\usepackage{titling}
\newcommand{\subtitle}[1]{%
  \posttitle{%
    \par\end{center}
    \begin{center}\large#1\end{center}
    \vskip0.5em}%
}

\begin{document}

\title{Lab 1}
\subtitle{CS M152A}
\author{Aman Agarwal \& Lowell Bander}

\maketitle
\tableofcontents
\newpage

\section{FPGA Design Workflow}

%TODO: complete this section

\subsection{Design}

The design stage of the FPGA development workflow is done outside of the the Xilinx ISE and its simulation tools, for it solely consists of the drawing of logical schematics so that the designer may understand the higher level functioning of the module to be constructed.

\subsection{Implementation}

The hierarchical file structure is determined based on which modules depend on others. At the very top-level we have a test bench file, \texttt{tb.v} which is directly above a unit under test file, \texttt{nexys3.v}. Below that we have a sequencer file and a uart file, \texttt{seq.v} and \texttt{uart\_top.v}. The sequencer is composed of the register file, \texttt{seq\_rf.v} and the ALU unit which has add and multiply modules. The Uart module represents the interface to the computer where we see the output. The Uart module is only needed for testing so it is not a part of the sequencer module.

\subsection{Simulation}

The simulation was done by loading the simulation files, choosing which signals to view/render, running the simulation for a short amount of time, and then examining the output to look for errors. Our simulation files were the test bench file and the model uart file, \texttt{tb.v} and \texttt{model\_uart.v}. The signals we chose to view were: \texttt{uut\_}, \texttt{inst\_wd}, and \texttt{inst\_vld}. After running the simulation, we looked at the \texttt{UART0} and noticed that it was exactly what we expected.

\subsection{Logic Synthesis}

To perform synthesis, we must import the synthesis file and then run synthesis using XST. The synthesis file contains the pin assignments and timing requirements. Our synthesis file is \texttt{nexys3.ucf}.

\subsection{Technology Mapping and Cell Placement}

Due to the lack of complexity in this project, we do not have to perform these steps.

\subsection{Route and Bitstream Generation}

These two steps are performed by the "Implement Design" part of ISE. This process outputs a bitstream file, \texttt{nexys3.bit}. We must then use the bitstream file and program the device before we can run programs on it.

\section{Example Program}

\begin{table}[H]
\centering
\begin{tabular}{ l | l }
\textbf{Sequencer Instruction} & \textbf{Binary}\\\hline
\texttt{PUSH R0 0x4} & \texttt{0000 0010}\\
\texttt{PUSH R0 0x0} & \texttt{0000 0000}\\
\texttt{PUSH R1 0x3} & \texttt{0001 0011}\\
\texttt{MULT R0 R1 R2} & \texttt{1000 0110}\\
\texttt{ADD R2 R0 R3} & \texttt{0110 0011}\\
\texttt{PUSH R0 0x4} & \texttt{0000 0100}\\
\texttt{SEND R0} & \texttt{1100  xxxx}\\
\texttt{SEND R1} & \texttt{1101  xxxx}\\
\texttt{SEND R2} & \texttt{1110  xxxx}\\
\texttt{SEND R3} & \texttt{1111  xxxx}\\
\end{tabular}
\caption{Sequencer instructions translated to binary. The four least significant bits are ``don't care'' as their value is not used for the \texttt{SEND} instruction.}
\label{table:translation}
\end{table}

\begin{figure}[H]
\centering
\includegraphics[width=10cm]{translation.PNG}
\caption{UART console output resulting from the executions in Table~\ref{table:translation}.}
\end{figure}

\section{Fibonacci}

For this section, we generated the first 10 Fibonacci numbers by writing the necessary sequencer instructions, translating them into machine instructions, and then loading them into the simulator using the \texttt{\$fopen} and \texttt{\$fscanf}.

\begin{table}[H]
\centering
\begin{tabular}{ l | l }
\textbf{Sequencer Instruction} & \textbf{Binary}\\\hline
\texttt{PUSH R0 0x0} & \texttt{0000 0000}\\
\texttt{PUSH R1 0x1} & \texttt{0001 0001}\\
\texttt{SEND R0} & \texttt{1100 xxxx}\\
\texttt{SEND R1} & \texttt{1101 xxxx}\\
\texttt{ADD R0 R1 R2} & \texttt{0100 0110}\\
\texttt{SEND R2} & \texttt{1110 xxxx}\\
\texttt{ADD R1 R2 R0} & \texttt{1001 1000}\\
\texttt{SEND R0} & \texttt{1100 xxxx}\\
\texttt{ADD R2 R0 R1} & \texttt{1010 0001}\\
\texttt{SEND R1} & \texttt{1101 xxxx}\\
\texttt{ADD R0 R1 R2} & \texttt{0100 0110}\\
\texttt{SEND R2} & \texttt{1110 xxxx}\\
\texttt{ADD R1 R2 R0} & \texttt{1001 1000}\\
\texttt{SEND R0} & \texttt{1100 xxxx}\\
\texttt{ADD R2 R0 R1} & \texttt{1010 0001}\\
\texttt{SEND R1} & \texttt{1101 xxxx}\\
\texttt{ADD R0 R1 R2} & \texttt{0100 0110}\\
\texttt{SEND R2} & \texttt{1110 xxxx}\\
\texttt{ADD R1 R2 R0} & \texttt{1001 1000}\\
\texttt{SEND R0} & \texttt{1100 xxxx}\\
\texttt{ADD R2 R0 R1} & \texttt{1010 0001}\\
\end{tabular}
\caption{The sequencer instructions, and their corresponding machine translations, necessary to generate the first 10 Fibonacci numbers. When loaded into simulation, the ``don't care'' values were substituted for \texttt{0}, but it is important to note that we could have just as easily used \texttt{1}.}
\label{table:fib}
\end{table}

\begin{figure}[H]
\centering
\includegraphics[width=10cm]{fib.PNG}
\caption{UART console output resulting from the executions in Table~\ref{table:fib}.}
\end{figure}

\section{Exercise 1}

%TODO: complete this section

\subsection{Clock Enable}
\begin{enumerate}
\item The signal \texttt{clk\_en} is a clock enable signal whose assertion is a prerequisite for the modification of the \texttt{inst\_wd} and \texttt{step\_d} signals, meaning that new instructions will only be executed by the sequencer module of this clock enable is asserted.
\item 
\item 
\item 
\end{enumerate}
\subsection{Instruction Valid}
\begin{enumerate}
\item 
\item 
\item 
\item 
\item 
\end{enumerate}
\subsection{Register File}
\begin{enumerate}
\item 
\item 
\item 
\item 
\item 
\end{enumerate}

\section{Exercise 2}

%TODO: complete this section

\subsection{Nicer UART Output}
\subsection{An Easier Way to Load Sequencer Program}

\begin{enumerate}
\item 
\item
\end{enumerate}

\begin{enumerate}
\item 
\item
\item
\end{enumerate}

\subsection{Fibonacci Numbers}

\end{document}